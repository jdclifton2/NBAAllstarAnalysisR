---
title: "Predicting NBA Allstars"
author: "Mohammed Bukhattala, Justin Clifton, Maxwell Pitney, Graham Swain"
date: "4/24/2021"
abstract: "Each NBA season, 24 players are selected to be allstars. The selection process involves fans voting for players they would like to see. Players voted in by fans are selected as starters and then coaches select the 7 bench players. We offer several models for predicting if a player is an allstar based on various statistics tracked throughout the season."
output: html_document
---

Models that did not work: QDA, Logistic.
```{r}
library(readr)
library(tibble)
library(ggplot2)
#library(GGally)
library(dplyr)
set.seed(23)
DF = read.csv("NBA_Stats_MVP.csv", header = TRUE)
nba_df = na.omit(DF)
names(nba_df)
nba_df$was_mvp = as.logical(nba_df$was_mvp)
nbaTib = as_tibble(nba_df)
cleanDF = select(nbaTib, -c(Pos, Tm, Name, Year, is_allstar))

# ggplot(nbaTib, aes(x = factor(is_allstar), fill = is_allstar)) +
#     geom_bar()
```


```{r}
ggplot(data = nbaTib) +
  geom_point(mapping = aes(x = FGA, y = FG, color = was_mvp, shape=was_mvp))
```


```{r}
ggplot(filter(DF, was_mvp == 1), aes(x = factor(Pos), fill = Pos)) +
    geom_bar() +
    scale_y_continuous(breaks=c(4,6,8,10,12)) +
    labs(title="NBA MVPS by Position (1974 - 2017)",
        x ="Position", y = "frequency")
```
```{r}
ggplot(filter(nbaTib, was_mvp == 1), aes(x = Pos, fill = Pos)) +
    geom_bar() +
    scale_y_continuous(breaks=c(4,6,8,10)) +
    labs(title="NBA MVPS by Position (1983 - 2017)",
        x ="Position", y = "frequency")
```


# Modeling

First we split the data into training and testing.
```{r}
train = sample(dim(cleanDF)[1], dim(cleanDF)[1]/2)
test = cleanDF[-train, ]
```

```{r}
#trying to make correlation map
# library(reshape2)
# library(ggcorrplot)
# names(cleanDF)
# cor = cor(cleanDF)
# as_tibble(cor[cor > 0.7])
# ggcorrplot(cor[cor > .7])
# ggplot(data = melted_cormat, aes(x=Var1, y=Var2, fill=value)) +
#   geom_tile()

```


We will now perform logistic regression.
```{r}
library(MASS)
lda_fit = lda(was_mvp~., data = cleanDF, subset=train)
lda_pred = predict(lda_fit, test)
table(lda_pred$class,test$was_mvp)
mean(lda_pred$class == test$was_mvp)
tpr = 18/(4 + 18)
fpr = 48/(48 + 7223)
tpr
fpr
cor
```
In the context of our problem, a true positive happens when a player was predicted as the MVP, and actually won the MVP. A true negative happens when a player was predicted as a non-MVP and was not the MVP. A false positive occurs when a player was predicted as the MVP but did not win the MVP. A false negative occurs when a player was predicted as a non-MVP but actually won the MVP. For this model, the overall accuracy is very high at $99.28699\%$. The model correctly predicted the MVP $81.81818\%$ of the time. At the same time, the model predicted a non-MVP as the MVP $0.6601568\%$ of the time.

```{r}
# qdaFit = qda(was_mvp~., data = cleanDF, subset = train)
# pred = predict(qdaFit, test)
# table(pred$class, test$was_mvp)
# mean(pred$class == test$was_mvp)
```





